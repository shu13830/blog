{
  
    
        "post0": {
            "title": "Pólya-Gamma データ拡大法",
            "content": "Pólya-Gamma データ拡大法 . Footnotes .",
            "url": "https://shu13830.github.io/blog/mcmc/2020/05/31/pgda.html",
            "relUrl": "/mcmc/2020/05/31/pgda.html",
            "date": " • May 31, 2020"
        }
        
    
  
    
        ,"post1": {
            "title": "Pólya-Gamma データ拡大法における識別可能性の問題",
            "content": "Pólya-Gamma データ拡大法における識別可能性の問題 . 以下の、対数正規-多項モデルを考える。 . x∈ RMy∼M(softmax(x)) begin{aligned} textbf{x} in&amp; mathbb{R}^M y sim&amp; mathcal{M}(softmax(x)) . end{aligned}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;x∈y∼​ RMM(softmax(x))​&lt;/span&gt;&lt;/span&gt; . 実数空間上の潜在変数 $x in mathbb{R}$ . Footnotes .",
            "url": "https://shu13830.github.io/blog/mcmc/2020/05/31/pgda-identifiability.html",
            "relUrl": "/mcmc/2020/05/31/pgda-identifiability.html",
            "date": " • May 31, 2020"
        }
        
    
  
    
        ,"post2": {
            "title": "Pólya-Gamma 分布",
            "content": "Pólya-Gamma 分布 . [Polson+, 2013] により提案された確率分布。 . 定義 . ω =D12π2∑k=1∞gk(k−1/2)2+c2/(4π2)gk∼Ga(b,1)(1) begin{aligned} omega overset{D}{=}&amp; dfrac{1}{2 pi^2} sum_{k=1}^{ infty} dfrac{g_k}{(k-1/2)^2+c^2/(4 pi^2)} g_k sim&amp; Ga(b,1) end{aligned} tag{1}ω =Dgk​∼​2π21​k=1∑∞​(k−1/2)2+c2/(4π2)gk​​Ga(b,1)​(1) . で表される確率変数 $ omega$ は、パラメータ $b&gt;0, c in mathbb{R}$を持つPólya-Gamma分布に従い、$ omega sim mathcal{PG}(b,c)$ と表せる。 . (1)の通り、ガンマ分布の無限畳み込みで定義されている。 . また、逆ガウス分布の交代級数の和としても定義でき、この表記が確率変数のサンプリングにおいて重要な役割を果たす。 . $ mathcal{PG}(1,0)$：Pólya分布 . $b=1, c=0$ の特殊ケースはPólya分布(Barndorff-Nielsen et al., 1982)として知られ、そのラプラス変換形式は、 . E{exp⁡(−ωt)}=1cosh⁡(t/2).(2) mathbb{E} { exp(- omega t) }= dfrac{1}{ cosh( sqrt{t/2})}. tag{2}E{exp(−ωt)}=cosh(t/2 . ​)1​.(2) . $ mathcal{PG}(b,0)$ . $c=0$ の特殊ケースのラプラス変換形式は、 . E{exp⁡(−ωt)}=∏i=1t(1+t2π2(k−1/2)2)−b=1cosh⁡b(t/2)(3) begin{aligned} mathbb{E} { exp(- omega t) } =&amp; prod_{i=1}^t left(1+ dfrac{t}{2 pi^2(k-1/2)^2} right)^{-b} =&amp; dfrac{1}{ cosh^b( sqrt{t/2})} end{aligned} tag{3}E{exp(−ωt)}==​i=1∏t​(1+2π2(k−1/2)2t​)−bcoshb(t/2 . ​)1​​(3) . であり、変数は以下で定義される。 . ω =D12π2∑k=1∞gk(k−1/2)2gk∼Ga(b,1)(4) begin{aligned} omega overset{D}{=}&amp; dfrac{1}{2 pi^2} sum_{k=1}^{ infty} dfrac{g_k}{(k-1/2)^2} g_k sim&amp; Ga(b,1) end{aligned} tag{4}ω =Dgk​∼​2π21​k=1∑∞​(k−1/2)2gk​​Ga(b,1)​(4) . さらに、逆ガンマ分布を用い確率密度関数は、 . f(ω∣b,0)=2b−1Γ(b)∑n=0∞(−1)nΓ(n+b)Γ(n+1)(2n+b)2πω3e−(2n+b)28ω(5)f( omega|b,0)= dfrac{2^{b-1}}{ Gamma(b)} sum_{n=0}^{ infty}(-1)^n dfrac{ Gamma(n+b)}{ Gamma(n+1)} dfrac{(2n+b)}{ sqrt{2 pi omega^3}} e^{- frac{(2n+b)^2}{8 omega}} tag{5}f(ω∣b,0)=Γ(b)2b−1​n=0∑∞​(−1)nΓ(n+1)Γ(n+b)​2πω3 . ​(2n+b)​e−8ω(2n+b)2​(5) . と書ける。 . また、[Biane+,2001]で扱われるヤコビシータ関数に密接に関係する確率分布$J^*(b), b&gt;0$のラプラス変換形式は、 . E{exp⁡(−tJ∗(b))}=1cosh⁡b(2t),(6) mathbb{E} { exp(-tJ^*(b)) } = dfrac{1}{ cosh^b( sqrt{2t})}, tag{6}E{exp(−tJ∗(b))}=coshb(2t . ​)1​,(6) . であることから、PG(b,0)と . PG(b,0)=D14J∗(b)(7)PG(b,0) overset{D}{=} dfrac{1}{4}J^*(b) tag{7}PG(b,0)=D41​J∗(b)(7) . という密接な関係を持つ。 . $ mathcal{PG}(b,c)$ . 確率密度関数は(1)のとおりだが、一般的なPG(b,c)クラスは、PG(b,c)確率密度の指数ティルティング1によって、 . p(ω∣b,c)=exp⁡(−c22ω)E{exp⁡(−c22ω)}p(ω∣b,0),(8)p( omega|b,c)= dfrac{ exp(- frac{c^2}{2} omega)}{ mathbb{E} { exp(- frac{c^2}{2} omega) }}p( omega|b,0), tag{8}p(ω∣b,c)=E{exp(−2c2​ω)}exp(−2c2​ω)​p(ω∣b,0),(8) . としても得られる。 . したがって、(6)(7)より、逆ガンマ分布を用いた確率密度関数は、 . f(ω∣b,c)={cosh⁡b(c/2)}2b−1Γ(b)∑n=0∞(−1)nΓ(n+b)Γ(n+1)(2n+b)2πω3e−(2n+b)28ω−c22ω(9)f( omega|b,c)= { cosh^b(c/2) } dfrac{2^{b-1}}{ Gamma(b)} sum_{n=0}^{ infty}(-1)^n dfrac{ Gamma(n+b)}{ Gamma(n+1)} dfrac{(2n+b)}{ sqrt{2 pi omega^3}} e^{- frac{(2n+b)^2}{8 omega}- frac{c^2}{2} omega} tag{9}f(ω∣b,c)={coshb(c/2)}Γ(b)2b−1​n=0∑∞​(−1)nΓ(n+1)Γ(n+b)​2πω3 . ​(2n+b)​e−8ω(2n+b)2​−2c2​ω(9) . として得られる。ここで、正規化定数はPG(b,0)のラプラス変換形式から直接得られる。 . 有用な性質 . PG確率変数の有限モーメントはクローズドフォームで得られ、平均は、 . E(ω)=b2ctanh⁡(c/2)=b2c(ec−11+ec),(10) mathbb{E}( omega)= dfrac{b}{2c} tanh(c/2)= dfrac{b}{2c} left( dfrac{e^c-1}{1+e^c} right), tag{10}E(ω)=2cb​tanh(c/2)=2cb​(1+ecec−1​),(10) . 分散は、 . Var(ω)=b4c3sech2(c/2)(sinh⁡(c)−c),(11) text{Var}( omega)= dfrac{b}{4c^3} text{sech}^2(c/2) left( sinh(c)-c right), tag{11}Var(ω)=4c3b​sech2(c/2)(sinh(c)−c),(11) . である。 . また、同じスケールパラメータ$c$を持つPG確率変数の畳み込みは閉じている。 そのため、独立な$ omega_1 sim mathcal{PG}(b_1,c)$および$ omega_2 sim mathcal{PG}(b_2,c)$について、 . ω1+ω2∼PG(b1+b2,c),(12) omega_1+ omega_2 sim mathcal{PG}(b_1+b_2, c), tag{12}ω1​+ω2​∼PG(b1​+b2​,c),(12) . が成り立つ。 . サンプラー . Vanilla . (1)に従い、無限個のガンマ分布からの独立したサンプルの加重和で$ omega$は得られるため、十分に大きな数$N$を用いて、 . ω ≈12π2∑k=1NGa(b,1)(k−1/2)2+c2/(4π2),(13) omega approx dfrac{1}{2 pi^2} sum_{k=1}^{N} dfrac{Ga(b,1)}{(k-1/2)^2+c^2/(4 pi^2)}, tag{13}ω ≈2π21​k=1∑N​(k−1/2)2+c2/(4π2)Ga(b,1)​,(13) . で近似できる。 . [Polson+, 13] の近似手法 . 上記の方法は遅く、また無限和を途中で切断して近似している点で危険性がある。 . 代替手法として、ヤコビシータ関数に密接に関連する分布$J^(1)$2の指数ティルティングを行なった$J^(1,z)$を用い、まず、PG(1,c)からb個の独立したサンプルを得る。 . その後、(10)の性質を用い、PG(1,c)からのサンプルの和を取りPG(β,c)からのサンプルを得る。 . fJ∗(1,c)(x∣z)=cosh⁡(c)e−xc2/2fJ∗(1)(x)PG(1,c)=14J∗(1,c/2)PG(b,c)=∑bPG(1,c)(12) begin{aligned} f_{J^*(1,c)}(x|z) =&amp; cosh(c)e^{-xc^2/2}f_{J^*(1)}(x) PG(1,c) =&amp; dfrac{1}{4}J^*(1,c/2) PG(b,c) =&amp; sum^b PG(1,c) end{aligned} tag{12}fJ∗(1,c)​(x∣z)=PG(1,c)=PG(b,c)=​cosh(c)e−xc2/2fJ∗(1)​(x)41​J∗(1,c/2)∑b​PG(1,c)​(12) . [Chen+, 13] の近似手法 . bが大きい場合、[Polson+,13]の方法では、PG(1,c)のサンプリング回数が線形に増加し計算に時間がかかる。 . そのため、bより小さいmを用いPG(m,c)のサンプルを用いてPG(b,c)を以下の様に近似する。 . $m &lt; b, omega sim mathcal{PG}(b, c), z sim mathcal{PG}(m, c)$ . ω≈f(z)=Var(ω)/Var(z)(z−E(z))+E(ω)=b/m(PG(m,c)−m2ctanh⁡(c2))+b2ctanh⁡(c2)(12) begin{aligned} omega approx f(z) &amp;= sqrt{Var( omega)/Var(z)}(z-E(z))+E( omega) &amp;= sqrt{b/m} left(PG(m,c)- frac{m}{2c} tanh( frac{c}{2}) right)+ frac{b}{2c} tanh( frac{c}{2}) end{aligned} tag{12}ω≈f(z)​=Var(ω)/Var(z) . ​(z−E(z))+E(ω)=b/m . ​(PG(m,c)−2cm​tanh(2c​))+2cb​tanh(2c​)​(12) . $m = 1$の場合、 . $z sim PG(1,c)$ . $f(z)= sqrt{b} left(z- frac{1}{2c} tanh( frac{c}{2}) right)+ frac{b}{2c} tanh( frac{c}{2})$ . $PG(b,c)= sqrt{b} left(PG(1,c)- frac{1}{2c} tanh( frac{c}{2}) right)+ frac{b}{2c} tanh( frac{c}{2})$ . [Glynn+, 19] の近似手法 . bが大きい場合を想定し、中心極限定理に基づき、PG(b,c)の期待値と分散を用いて正規分布からのサンプル生成を行う。 . ω∼N(E(ω),Var(ω)) omega sim mathcal{N}( mathbb{E}( omega), text{Var}( omega))ω∼N(E(ω),Var(ω)) . サンプリング例 . 上記の各近似手法を実装してPG(b=40, c=-1.81)からのサンプリングを行った結果 . . References . Polson, N.G., Scott, J.G. &amp; Windle, J. Bayesian inference for logistic models using Polya-gamma latent variables. J. Am. Stat. Assoc. 108, 1339–1349 (2013). | J. Chen, J. Zhu, Z. Wang, X. Zheng and B. Zhang, “Scalable inference for logistic-normal topic models”, NIPS, pp. 2445-2453, 2013. | Glynn, C., S. T. Tokdar, B. Howard, and D. L. Banks (2019, 03). Bayesian analysis of dynamic linear topic models. Bayesian Anal. 14(1), 53–80. Footnotes . | . 棄却サンプリングやインポータンスサンプリングで使用される分布シフト手法。 &#8617; . | [Polson+, 13]では$J^*(1)$をヤコビ分布と呼んでいる。 &#8617; . |",
            "url": "https://shu13830.github.io/blog/%E7%A2%BA%E7%8E%87%E5%88%86%E5%B8%83/2020/05/30/pgdist.html",
            "relUrl": "/%E7%A2%BA%E7%8E%87%E5%88%86%E5%B8%83/2020/05/30/pgdist.html",
            "date": " • May 30, 2020"
        }
        
    
  
    
        ,"post3": {
            "title": "Fastpages Notebook Blog Post",
            "content": "About . This notebook is a demonstration of some of capabilities of fastpages with notebooks. . With fastpages you can save your jupyter notebooks into the _notebooks folder at the root of your repository, and they will be automatically be converted to Jekyll compliant blog posts! . Front Matter . The first cell in your Jupyter Notebook or markdown blog post contains front matter. Front matter is metadata that can turn on/off options in your Notebook. It is formatted like this: . # &quot;My Title&quot; &gt; &quot;Awesome summary&quot; - toc:true- branch: master- badges: true- comments: true - author: Hamel Husain &amp; Jeremy Howard - categories: [fastpages, jupyter] . Setting toc: true will automatically generate a table of contents | Setting badges: true will automatically include GitHub and Google Colab links to your notebook. | Setting comments: true will enable commenting on your blog post, powered by utterances. | . The title and description need to be enclosed in double quotes only if they include special characters such as a colon. More details and options for front matter can be viewed on the front matter section of the README. . Markdown Shortcuts . A #hide comment at the top of any code cell will hide both the input and output of that cell in your blog post. . A #hide_input comment at the top of any code cell will only hide the input of that cell. . The comment #hide_input was used to hide the code that produced this. . put a #collapse-hide flag at the top of any cell if you want to hide that cell by default, but give the reader the option to show it: . #collapse-hide import pandas as pd import altair as alt . . put a #collapse-show flag at the top of any cell if you want to show that cell by default, but give the reader the option to hide it: . #collapse-show cars = &#39;https://vega.github.io/vega-datasets/data/cars.json&#39; movies = &#39;https://vega.github.io/vega-datasets/data/movies.json&#39; sp500 = &#39;https://vega.github.io/vega-datasets/data/sp500.csv&#39; stocks = &#39;https://vega.github.io/vega-datasets/data/stocks.csv&#39; flights = &#39;https://vega.github.io/vega-datasets/data/flights-5k.json&#39; . . Interactive Charts With Altair . Charts made with Altair remain interactive. Example charts taken from this repo, specifically this notebook. . Example 1: DropDown . # single-value selection over [Major_Genre, MPAA_Rating] pairs # use specific hard-wired values as the initial selected values selection = alt.selection_single( name=&#39;Select&#39;, fields=[&#39;Major_Genre&#39;, &#39;MPAA_Rating&#39;], init={&#39;Major_Genre&#39;: &#39;Drama&#39;, &#39;MPAA_Rating&#39;: &#39;R&#39;}, bind={&#39;Major_Genre&#39;: alt.binding_select(options=genres), &#39;MPAA_Rating&#39;: alt.binding_radio(options=mpaa)} ) # scatter plot, modify opacity based on selection alt.Chart(movies).mark_circle().add_selection( selection ).encode( x=&#39;Rotten_Tomatoes_Rating:Q&#39;, y=&#39;IMDB_Rating:Q&#39;, tooltip=&#39;Title:N&#39;, opacity=alt.condition(selection, alt.value(0.75), alt.value(0.05)) ) . Example 2: Tooltips . alt.Chart(movies).mark_circle().add_selection( alt.selection_interval(bind=&#39;scales&#39;, encodings=[&#39;x&#39;]) ).encode( x=&#39;Rotten_Tomatoes_Rating:Q&#39;, y=alt.Y(&#39;IMDB_Rating:Q&#39;, axis=alt.Axis(minExtent=30)), # use min extent to stabilize axis title placement tooltip=[&#39;Title:N&#39;, &#39;Release_Date:N&#39;, &#39;IMDB_Rating:Q&#39;, &#39;Rotten_Tomatoes_Rating:Q&#39;] ).properties( width=600, height=400 ) . Example 3: More Tooltips . # select a point for which to provide details-on-demand label = alt.selection_single( encodings=[&#39;x&#39;], # limit selection to x-axis value on=&#39;mouseover&#39;, # select on mouseover events nearest=True, # select data point nearest the cursor empty=&#39;none&#39; # empty selection includes no data points ) # define our base line chart of stock prices base = alt.Chart().mark_line().encode( alt.X(&#39;date:T&#39;), alt.Y(&#39;price:Q&#39;, scale=alt.Scale(type=&#39;log&#39;)), alt.Color(&#39;symbol:N&#39;) ) alt.layer( base, # base line chart # add a rule mark to serve as a guide line alt.Chart().mark_rule(color=&#39;#aaa&#39;).encode( x=&#39;date:T&#39; ).transform_filter(label), # add circle marks for selected time points, hide unselected points base.mark_circle().encode( opacity=alt.condition(label, alt.value(1), alt.value(0)) ).add_selection(label), # add white stroked text to provide a legible background for labels base.mark_text(align=&#39;left&#39;, dx=5, dy=-5, stroke=&#39;white&#39;, strokeWidth=2).encode( text=&#39;price:Q&#39; ).transform_filter(label), # add text labels for stock prices base.mark_text(align=&#39;left&#39;, dx=5, dy=-5).encode( text=&#39;price:Q&#39; ).transform_filter(label), data=stocks ).properties( width=700, height=400 ) . Data Tables . You can display tables per the usual way in your blog: . movies = &#39;https://vega.github.io/vega-datasets/data/movies.json&#39; df = pd.read_json(movies) # display table with pandas df[[&#39;Title&#39;, &#39;Worldwide_Gross&#39;, &#39;Production_Budget&#39;, &#39;Distributor&#39;, &#39;MPAA_Rating&#39;, &#39;IMDB_Rating&#39;, &#39;Rotten_Tomatoes_Rating&#39;]].head() . Title Worldwide_Gross Production_Budget Distributor MPAA_Rating IMDB_Rating Rotten_Tomatoes_Rating . 0 The Land Girls | 146083.0 | 8000000.0 | Gramercy | R | 6.1 | NaN | . 1 First Love, Last Rites | 10876.0 | 300000.0 | Strand | R | 6.9 | NaN | . 2 I Married a Strange Person | 203134.0 | 250000.0 | Lionsgate | None | 6.8 | NaN | . 3 Let&#39;s Talk About Sex | 373615.0 | 300000.0 | Fine Line | None | NaN | 13.0 | . 4 Slam | 1087521.0 | 1000000.0 | Trimark | R | 3.4 | 62.0 | . Images . Local Images . You can reference local images and they will be copied and rendered on your blog automatically. You can include these with the following markdown syntax: . ![](my_icons/fastai_logo.png) . . Remote Images . Remote images can be included with the following markdown syntax: . ![](https://image.flaticon.com/icons/svg/36/36686.svg) . . Animated Gifs . Animated Gifs work, too! . ![](https://upload.wikimedia.org/wikipedia/commons/7/71/ChessPawnSpecialMoves.gif) . . Captions . You can include captions with markdown images like this: . ![](https://www.fast.ai/images/fastai_paper/show_batch.png &quot;Credit: https://www.fast.ai/2020/02/13/fastai-A-Layered-API-for-Deep-Learning/&quot;) . . Other Elements . GitHub Flavored Emojis . Typing I give this post two :+1:! will render this: . I give this post two :+1:! . Tweetcards . Typing &gt; twitter: https://twitter.com/jakevdp/status/1204765621767901185?s=20 will render this: Altair 4.0 is released! https://t.co/PCyrIOTcvvTry it with: pip install -U altairThe full list of changes is at https://t.co/roXmzcsT58 ...read on for some highlights. pic.twitter.com/vWJ0ZveKbZ . &mdash; Jake VanderPlas (@jakevdp) December 11, 2019 . Youtube Videos . Typing &gt; youtube: https://youtu.be/XfoYk_Z5AkI will render this: . Boxes / Callouts . Typing &gt; Warning: There will be no second warning! will render this: . Warning: There will be no second warning! . Typing &gt; Important: Pay attention! It&#39;s important. will render this: . Important: Pay attention! It&#8217;s important. . Typing &gt; Tip: This is my tip. will render this: . Tip: This is my tip. . Typing &gt; Note: Take note of this. will render this: . Note: Take note of this. . Typing &gt; Note: A doc link to [an example website: fast.ai](https://www.fast.ai/) should also work fine. will render in the docs: . Note: A doc link to an example website: fast.ai should also work fine. . Footnotes . You can have footnotes in notebooks, however the syntax is different compared to markdown documents. This guide provides more detail about this syntax, which looks like this: . For example, here is a footnote {% fn 1 %}. And another {% fn 2 %} {{ &#39;This is the footnote.&#39; | fndetail: 1 }} {{ &#39;This is the other footnote. You can even have a [link](www.github.com)!&#39; | fndetail: 2 }} . For example, here is a footnote 1. . And another 2 . 1. This is the footnote.↩ . 2. This is the other footnote. You can even have a link!↩ .",
            "url": "https://shu13830.github.io/blog/jupyter/2020/02/20/test.html",
            "relUrl": "/jupyter/2020/02/20/test.html",
            "date": " • Feb 20, 2020"
        }
        
    
  
    
        ,"post4": {
            "title": "An Example Markdown Post",
            "content": "Example Markdown Post . Basic setup . Jekyll requires blog post files to be named according to the following format: . YEAR-MONTH-DAY-filename.md . Where YEAR is a four-digit number, MONTH and DAY are both two-digit numbers, and filename is whatever file name you choose, to remind yourself what this post is about. .md is the file extension for markdown files. . The first line of the file should start with a single hash character, then a space, then your title. This is how you create a “level 1 heading” in markdown. Then you can create level 2, 3, etc headings as you wish but repeating the hash character, such as you see in the line ## File names above. . Basic formatting . You can use italics, bold, code font text, and create links. Here’s a footnote 1. Here’s a horizontal rule: . . Lists . Here’s a list: . item 1 | item 2 | . And a numbered list: . item 1 | item 2 | Boxes and stuff . This is a quotation . . You can include alert boxes …and… . . You can include info boxes Images . . Code . You can format text and code per usual . General preformatted text: . # Do a thing do_thing() . Python code and output: . # Prints &#39;2&#39; print(1+1) . 2 . Formatting text as shell commands: . echo &quot;hello world&quot; ./some_script.sh --option &quot;value&quot; wget https://example.com/cat_photo1.png . Formatting text as YAML: . key: value - another_key: &quot;another value&quot; . Tables . Column 1 Column 2 . A thing | Another thing | . Tweetcards . Altair 4.0 is released! https://t.co/PCyrIOTcvvTry it with: pip install -U altairThe full list of changes is at https://t.co/roXmzcsT58 ...read on for some highlights. pic.twitter.com/vWJ0ZveKbZ . &mdash; Jake VanderPlas (@jakevdp) December 11, 2019 Footnotes . This is the footnote. &#8617; . |",
            "url": "https://shu13830.github.io/blog/markdown/2020/01/14/test-markdown-post.html",
            "relUrl": "/markdown/2020/01/14/test-markdown-post.html",
            "date": " • Jan 14, 2020"
        }
        
    
  

  
  

  
      ,"page1": {
          "title": "About Me",
          "content": "This is where you put the contents of your About page. Like all your pages, it’s in Markdown format. . This website is powered by fastpages 1. . a blogging platform that natively supports Jupyter notebooks in addition to other formats. &#8617; . |",
          "url": "https://shu13830.github.io/blog/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  
  

  

  
  

  

  
  

  
  

  
  

  
      ,"page10": {
          "title": "",
          "content": "Sitemap: {{ “sitemap.xml” | absolute_url }} | .",
          "url": "https://shu13830.github.io/blog/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

}